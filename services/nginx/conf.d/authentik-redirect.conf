# Authentik Sign-In Redirect Configuration
#
# Handles redirecting unauthenticated users to Authentik login
# Include this in server blocks using forward auth
#

# Redirect unauthenticated users to Authentik login
location @authentik_proxy_signin {
    internal;
    
    # Build the redirect URL to Authentik
    # After login, user will be sent back to original URL
    add_header Set-Cookie $authentik_cookie;
    return 302 https://auth.7gram.xyz/outpost.goauthentik.io/start?rd=$scheme://$http_host$request_uri;
}
